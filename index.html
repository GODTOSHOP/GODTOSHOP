<canvas id="rocket"></canvas>
<script>
// کانواس و تنظیمات موشک
const rocketCanvas = document.getElementById('rocket');
const rCtx = rocketCanvas.getContext('2d');
rocketCanvas.width = window.innerWidth;
rocketCanvas.height = window.innerHeight;

let rocket = {
  x: -50,
  y: 50,
  targetX: window.innerWidth/2,
  targetY: window.innerHeight - 150,
  size: 40,
  speed: 4,
  reached: false
};

// افکت Trail
let trail = [];

function drawRocket() {
  rCtx.clearRect(0,0,rocketCanvas.width,rocketCanvas.height);

  // اضافه کردن موقعیت فعلی به Trail
  trail.push({x: rocket.x, y: rocket.y, alpha:1});
  trail = trail.map(t=>({x:t.x, y:t.y, alpha: t.alpha-0.02})).filter(t=>t.alpha>0);

  // کشیدن Trail
  trail.forEach(t=>{
    rCtx.beginPath();
    rCtx.arc(t.x, t.y, rocket.size/6, 0, Math.PI*2);
    rCtx.fillStyle = `rgba(0,255,255,${t.alpha})`;
    rCtx.fill();
  });

  // کشیدن موشک (مثل مثلث کوچک)
  rCtx.beginPath();
  rCtx.moveTo(rocket.x, rocket.y);
  rCtx.lineTo(rocket.x-rocket.size/2, rocket.y+rocket.size);
  rCtx.lineTo(rocket.x+rocket.size/2, rocket.y+rocket.size);
  rCtx.closePath();
  rCtx.fillStyle = "#ff1744";
  rCtx.fill();
  rCtx.strokeStyle = "#0ff";
  rCtx.stroke();

  // حرکت موشک به سمت هدف
  if(!rocket.reached){
    let dx = rocket.targetX - rocket.x;
    let dy = rocket.targetY - rocket.y;
    let dist = Math.sqrt(dx*dx + dy*dy);
    if(dist < 5){
      rocket.reached = true;
      createExplosion(rocket.x, rocket.y);
    } else {
      rocket.x += dx/ dist * rocket.speed;
      rocket.y += dy/ dist * rocket.speed;
    }
  }

  requestAnimationFrame(drawRocket);
}

// افکت انفجار
let explosions = [];
function createExplosion(x,y){
  for(let i=0;i<20;i++){
    explosions.push({
      x, y,
      dx: (Math.random()-0.5)*6,
      dy: (Math.random()-0.5)*6,
      size: Math.random()*6+4,
      alpha:1
    });
  }
}

function drawExplosion(){
  explosions.forEach((e,i)=>{
    rCtx.beginPath();
    rCtx.arc(e.x, e.y, e.size,0,Math.PI*2);
    rCtx.fillStyle = `rgba(255,255,255,${e.alpha})`;
    rCtx.fill();
    e.x += e.dx;
    e.y += e.dy;
    e.alpha -=0.03;
    if(e.alpha<=0) explosions.splice(i,1);
  });
}

// ترکیب موشک و انفجار
function animateRocket(){
  drawRocket();
  drawExplosion();
  requestAnimationFrame(animateRocket);
}

animateRocket();

// ریست موشک بعد از انفجار
setInterval(()=>{
  if(rocket.reached){
    rocket.x = -50;
    rocket.y = 50;
    rocket.reached = false;
    trail = [];
  }
}, 8000);

// resize
window.addEventListener('resize', ()=>{
  rocketCanvas.width = window.innerWidth;
  rocketCanvas.height = window.innerHeight;
  rocket.targetX = window.innerWidth/2;
  rocket.targetY = window.innerHeight - 150;
});
</script>
